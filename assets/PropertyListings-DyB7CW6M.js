import{u as $,j as e,B as v,T as j,a as D,b as A,r as s,H}from"./index-C2hfVn6k.js";import{P as U}from"./PropertyCard2-Br7hxPlu.js";import{H as z}from"./HomeWorkOutlined-skMYUjx6.js";import{u as G}from"./index-1rqe2FLV.js";import I from"./PropertyForm-BwgF6pqq.js";import{F as O}from"./FullPageLoader-D93dE52d.js";import{G as g}from"./Grid-BNK0cvxE.js";import"./Hotel-B0R_E2y9.js";import"./CardContent-CVYRDK_0.js";import"./CardMedia-CtTbO1ES.js";import"./Constants-D6TUlAnp.js";import"./swiper-bundle-BjZ7TqKU.js";const Q=()=>{const a=$(),i=G(a.breakpoints.down("sm")),m=()=>{window.location.href=window.location.pathname};return e.jsxs(v,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",p:i?3:6,m:"auto",maxWidth:i?320:500,bgcolor:a.palette.mode==="light"?"#f5f5f5":a.palette.background.paper,borderRadius:3,boxShadow:a.palette.mode==="light"?2:0,sx:{mt:4},children:[e.jsx(z,{sx:{fontSize:i?48:72,color:a.palette.text.disabled,mb:2}}),e.jsx(j,{variant:i?"h6":"h5",fontWeight:600,gutterBottom:!0,children:"No Property Listings Match"}),e.jsx(j,{variant:"body2",color:"text.secondary",mb:2,children:"Try resetting your filters to explore more properties."}),e.jsx(D,{variant:"contained",color:"primary",size:"medium",onClick:m,children:"Reset Filters"})]})},ie=({apiUrl:a})=>{const i=A(),m=window.location.pathname,[h,p]=s.useState(!1),[x,f]=s.useState(""),[c,b]=s.useState([]),[w,N]=s.useState(null),o=s.useMemo(()=>{const n=i.pathname.split("/").filter(Boolean),l={};return n.forEach(y=>{const[u,...k]=y.split("-");u&&k.length>0&&(l[u]=k.join("-"))}),l},[i.pathname]),[t,M]=s.useState({sectorType:m.startsWith("/for-rent")?"rent":"sale",propertyType:o.propertyType||"",listingType:o.listingType||"",community:o.community||"",developer:o.developer||"",keywords:o.keywords||"",year:o.year||"",furnishing:o.furnishing||"",minPrice:Number(o.minPrice)||0,maxPrice:Number(o.maxPrice)||0,areaMin:Number(o.areaMin)||0,areaMax:Number(o.areaMax)||0,amenities:o.amenities||"",tourTypes:o.tourTypes||"",bedrooms:o.beds||"",bathrooms:o.baths||"",occupant_status:o.status||""}),T=s.useRef(0),[d,F]=s.useState(1),[R,E]=s.useState(1),[P,B]=s.useState("Properties"),[C,L]=s.useState(0),W=s.useRef(t),r=s.useRef(t);s.useEffect(()=>{m.startsWith("/for-sale")?f("for-sale"):m.startsWith("/for-rent")&&f("for-rent")},[]),s.useEffect(()=>{W.current=t},[t]),s.useEffect(()=>{console.log(t),(t.sectorType!==r.current.sectorType||t.propertyType!==r.current.propertyType||t.listingType!==r.current.listingType||t.minPrice!==r.current.minPrice||t.maxPrice!==r.current.maxPrice||t.amenities!==r.current.amenities||t.tourTypes!==r.current.tourTypes||t.keywords!==r.current.keywords||t.areaMin!==r.current.areaMin||t.furnishing!==r.current.furnishing||t.areaMax!==r.current.areaMax||t.community!==r.current.community||t.developer!==r.current.developer||t.year!==r.current.year||t.bedrooms!==r.current.bedrooms||t.bathrooms!==r.current.bathrooms||t.occupant_status!==r.current.occupant_status)&&(S(),r.current=t)},[t,d]);const S=async()=>{p(!0),N(null);try{const n=new URLSearchParams({sectorType:t.sectorType,propertyType:t.propertyType,listingType:t.listingType,community:t.community,minPrice:t.minPrice.toString(),maxPrice:t.maxPrice.toString(),amenities:t.amenities.toString(),tourTypes:t.tourTypes.toString(),keywords:t.keywords.toString(),areaMin:t.areaMin.toString(),areaMax:t.areaMax.toString(),furnishing:t.furnishing.toString(),bedrooms:t.bedrooms,bathrooms:t.bathrooms,developer:t.developer,year:t.year,occupant_status:t.occupant_status,page:d.toString()}),l=`${a}?${n.toString()}`,y=await fetch(l);if(!y.ok)throw new Error("Failed to fetch properties");const u=await y.json();b(u.data.records||[]),E(u.data.total_pages),B(u.data.title||"Properties"),L(Number(u.data.count)||0)}catch(n){console.error("Error fetching properties:",n),N("Failed to load properties. Please try again later.")}finally{p(!1)}},_=n=>{if(n!==d){window.scrollTo({top:0,behavior:"smooth"});const l=new URLSearchParams(window.location.search);l.set("page",n.toString());const y=`${window.location.pathname}?${l.toString()}`;window.history.pushState({},"",y),console.log(n+"currentPage"+d),F(n)}};return s.useEffect(()=>{d!==T.current&&(T.current=d,S())},[d]),e.jsxs("div",{children:[e.jsxs("div",{className:"section-dark page-banner list-banner-home for-listing-page only-property not-mob",id:x,children:[e.jsx("div",{className:"full-block page-banner-image"}),e.jsx("div",{className:"full-block overlay"}),e.jsx("div",{className:"container",children:e.jsx("div",{className:"row disp-table",children:e.jsx("div",{className:"col-sm-12",children:e.jsx("div",{className:"page-banner-content",children:e.jsx("div",{className:"property-search property-search-full",children:e.jsx(I,{origin:"list",setFormData:M})})})})})})]}),w&&e.jsx("p",{children:w}),e.jsxs(H,{children:[e.jsx("title",{children:P})," "]}),e.jsx("div",{className:"section page-section listing-page-m pt20",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:" ",children:e.jsx("div",{className:"col  mb15 p-my",children:e.jsx(e.Fragment,{children:c.length>0?e.jsx(e.Fragment,{children:e.jsx(g,{container:!0,spacing:2,children:e.jsx(g,{item:!0,xs:12,sm:9,children:c.length>0?e.jsxs(v,{children:[e.jsx(j,{variant:"h5",fontWeight:600,gutterBottom:!0,children:P}),e.jsxs(j,{variant:"body2",color:"text.secondary",children:[C," properties found"]})]}):e.jsx(v,{})})})}):e.jsx("div",{})})})}),e.jsx("div",{className:"row",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fancy-title-hold text-left clearfix",children:e.jsxs("div",{className:"col-sm-9 ml5",children:[e.jsx("h2",{className:"site-h2 mb-0 skeleton-item",style:{width:"150px",marginBottom:"15px",height:"30px"},children:" "}),e.jsx("div",{className:"m5"}),e.jsx("div",{className:"skeleton-item",style:{width:"100px",marginBottom:"15px",height:"15px"},children:" "})]})}),e.jsx("div",{className:"row",children:e.jsx(O,{})})]}):!Array.isArray(c)||c.length===0?e.jsx(Q,{}):e.jsx("div",{className:"parent-div",children:e.jsx(g,{container:!0,spacing:3,children:c.map((n,l)=>e.jsx(g,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(U,{property:n})},`${n.id??l}-${l}`))})})})]})}),e.jsx("div",{className:"clearfix"}),e.jsx(q,{currentPage:d,totalPages:R,onPageChange:_}),e.jsx("div",{className:"clearfix"})]})},q=({currentPage:a,totalPages:i,onPageChange:m})=>{if(i<=1)return null;const h=5;let p=a-Math.floor(h/2),x=a+Math.floor(h/2);p<1?(p=1,x=Math.min(h,i)):x>i&&(x=i,p=Math.max(1,i-h+1));const f=Array.from({length:x-p+1},(c,b)=>p+b);return e.jsxs("div",{className:"custom-pagination",children:[a>1&&e.jsx("button",{onClick:()=>m(a-1),children:"«"}),f.map(c=>e.jsx("button",{className:c===a?"active":"",onClick:()=>m(c),children:c},c)),a<i&&e.jsx("button",{onClick:()=>m(a+1),children:"»"})]})};export{ie as default};
